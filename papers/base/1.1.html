<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>变量和类型 | Yawn Blog</title>
    <meta name="description" content="Yawn的博客">
    <link rel="icon" href="/blog/favicon.ico">
    
    <link rel="preload" href="/blog/assets/css/0.styles.58d190e7.css" as="style"><link rel="preload" href="/blog/assets/js/app.15abdfdd.js" as="script"><link rel="preload" href="/blog/assets/js/2.d82f687a.js" as="script"><link rel="preload" href="/blog/assets/js/9.e3aba813.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.718639e1.js"><link rel="prefetch" href="/blog/assets/js/11.180dba1c.js"><link rel="prefetch" href="/blog/assets/js/12.dc856bc5.js"><link rel="prefetch" href="/blog/assets/js/13.1cac4ecf.js"><link rel="prefetch" href="/blog/assets/js/14.c722c837.js"><link rel="prefetch" href="/blog/assets/js/3.cb480f5b.js"><link rel="prefetch" href="/blog/assets/js/4.c844e552.js"><link rel="prefetch" href="/blog/assets/js/5.0f466136.js"><link rel="prefetch" href="/blog/assets/js/6.f02be6bd.js"><link rel="prefetch" href="/blog/assets/js/7.ffc9d8de.js"><link rel="prefetch" href="/blog/assets/js/8.0c8d4d5d.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.58d190e7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="/blog/user-avatar.jpg" alt="Yawn Blog" class="logo"> <span class="site-name can-hide">Yawn Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">Home</a></div><div class="nav-item"><a href="/blog/papers/base/" class="nav-link router-link-active">基础</a></div><div class="nav-item"><a href="/blog/papers/advance/" class="nav-link">进阶</a></div><div class="nav-item"><a href="/blog/papers/algorithm/" class="nav-link">算法</a></div> <a href="https://github.com/Yaaawn/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">Home</a></div><div class="nav-item"><a href="/blog/papers/base/" class="nav-link router-link-active">基础</a></div><div class="nav-item"><a href="/blog/papers/advance/" class="nav-link">进阶</a></div><div class="nav-item"><a href="/blog/papers/algorithm/" class="nav-link">算法</a></div> <a href="https://github.com/Yaaawn/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>JavaScript 基础</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/papers/base/1.1.html" class="active sidebar-link">变量和类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/papers/base/1.1.html#基本概念" class="sidebar-link">基本概念</a></li><li class="sidebar-sub-header"><a href="/blog/papers/base/1.1.html#基本数据类型常见问题" class="sidebar-link">基本数据类型常见问题</a></li><li class="sidebar-sub-header"><a href="/blog/papers/base/1.1.html#引用数据类型常见问题" class="sidebar-link">引用数据类型常见问题</a></li></ul></li><li><a href="/blog/papers/base/1.2.html" class="sidebar-link">如何判断数据类型？</a></li><li><a href="/blog/papers/base/1.3.html" class="sidebar-link">构造函数、原型和原型链</a></li><li><a href="/blog/papers/base/1.4.html" class="sidebar-link">实现继承的几种方式及优缺点</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="变量和类型"><a href="#变量和类型" class="header-anchor">#</a> 变量和类型</h1> <h2 id="基本概念"><a href="#基本概念" class="header-anchor">#</a> 基本概念</h2> <h3 id="什么是变量？"><a href="#什么是变量？" class="header-anchor">#</a> 什么是变量？</h3> <p>变量来源于数学，在计算机语言中是指能储存计算结果或能表示值的抽象概念。我们在程序中常常需要保存和处理数据，当程序中需要使用数据时，可以定义某种类型的变量，通过变量名来访问存储这段数据的内存。所以，从本质上看，变量代表了一段可操作的内存，也可以认为变量是内存的符号化表示。</p> <h3 id="javascript-中有几种数据类型？"><a href="#javascript-中有几种数据类型？" class="header-anchor">#</a> JavaScript 中有几种数据类型？</h3> <h4 id="_7种基本数据类型"><a href="#_7种基本数据类型" class="header-anchor">#</a> 7种基本数据类型</h4> <ul><li><strong>Undefined</strong> ———— 未定义类型</li> <li><strong>Null</strong> ———— 空类型</li> <li><strong>Boolean</strong> ———— 布尔类型</li> <li><strong>Number</strong> ———— 数字类型</li> <li><strong>String</strong> ———— 字符串类型</li> <li><strong>Symbol</strong> ———— 表示独一无二的值</li> <li><strong>BigInt</strong> ———— 任意精度整数类型</li></ul> <h4 id="_1种引用数据类型"><a href="#_1种引用数据类型" class="header-anchor">#</a> 1种引用数据类型</h4> <ul><li><strong>Object</strong> ———— 对象类型
<ul><li>Function</li> <li>Array</li> <li>Class</li> <li>Date</li> <li>RegExp</li> <li>Math</li> <li>JSON</li> <li>Error</li></ul></li></ul> <h3 id="变量在内存中的具体存储形式？"><a href="#变量在内存中的具体存储形式？" class="header-anchor">#</a> 变量在内存中的具体存储形式？</h3> <ul><li>基本类型保存在栈内存中，值有固定大小，通过按值访问。</li> <li>引用类型保存在堆内存中，值的大小不固定。栈内存中存放该对象的访问地址指针，指向堆内存中的对象。JavaScript 中不允许直接访问堆内存中的位置。因此操作对象时，实际操作的是对象的引用。</li></ul> <h2 id="基本数据类型常见问题"><a href="#基本数据类型常见问题" class="header-anchor">#</a> 基本数据类型常见问题</h2> <h3 id="如何理解-undefinde-和-null-？"><a href="#如何理解-undefinde-和-null-？" class="header-anchor">#</a> 如何理解 undefinde 和 null ？</h3> <ul><li>undefined 表示一个变量未初始化。若一个变量声明时未进行初始化（赋值），则为 undefined。</li> <li>null 表示一个对象不存在，若一个变量或一段函数返回的结果期望为一个对象，则在该对象尚未存在时访问它就会返回为 null。</li> <li>即：undefined 表示空变量，null 表示空对象。</li></ul> <h3 id="symbol-在实际开发中的作用？"><a href="#symbol-在实际开发中的作用？" class="header-anchor">#</a> Symbol 在实际开发中的作用？</h3> <p>首先需要理解 Symbol 是一种无法被重建的基本类型。看一个例子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> s1 <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> s2 <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> s3 <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'s'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> s4 <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'s'</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s1 <span class="token operator">==</span> s1<span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s1 <span class="token operator">==</span> s2<span class="token punctuation">)</span> <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s1 <span class="token operator">===</span> s2<span class="token punctuation">)</span> <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s1 <span class="token operator">==</span> s3<span class="token punctuation">)</span> <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s3 <span class="token operator">==</span> s4<span class="token punctuation">)</span> <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s3 <span class="token operator">===</span> s4<span class="token punctuation">)</span> <span class="token comment">// false</span>
</code></pre></div><p>我们可以看到 Symbol 虽然是一种基本数据类型，但是该类型的变量除了与自身相等外，和其余变量皆互不相等，有点类似于对象创建的实例互不相等的情况。所以这种独特的特性就给 Symbol 带来了独特的应用场景。</p> <ul><li><strong>用来代替常量</strong><br>
在实际业务中，我们常常定义一组常量来代表一种业务逻辑下的几种不同类型，而这几个常量之间需要保证唯一性，为了保证这一点，我们需要为每个常量赋一个唯一的值，而现在可以直接使用 Symbol 来为这些常量赋值。</li> <li><strong>作为对象的属性</strong> <ul><li><strong>阻止对象属性名冲突</strong>
在不知道对象原有属性名的情况下，可用来扩展对象的属性。
例如当两个不同的库要读取对象的一些原始属性时，可以在初始化时生成其所需的 symbols ，然后在对象上任意赋值。</li> <li><strong>模拟私有属性</strong>
使用 Symbol 作为属性名的对象，在序列化器中该属性会被隐藏。在形如 <code>Object.keys()</code> 或 <code>for...in</code> 的操作中，并不会获取到 symbols ，<code>JSON.stringify()</code> 的输出也不会包含 symbols 。但是可以通过 <code>Reflect.ownKeys()</code> 来获取。
但一般情况下如果对 Symbol 属性没有直接的引用，则无法访问到该属性的值。所以可以用来定义类的私有属性/方法。</li></ul></li> <li><strong>注册和获取全局 Symbol</strong><br>
使用 <code>Symbol.for()</code> 可以注册或获取一个 windows 间全局的 Symbol 实例。</li></ul> <h3 id="手动实现一个-symbol-？"><a href="#手动实现一个-symbol-？" class="header-anchor">#</a> 手动实现一个 symbol ？</h3> <h4 id="分析"><a href="#分析" class="header-anchor">#</a> 分析</h4> <p>如果需要模拟实现一个 Symbol 的话，需要构建一个 Symbol 函数，然后直接返回一个独一无二的值。首先让我们看看 Symbol 的特性：</p> <blockquote><ol><li>通过 Symbol 函数生成。</li> <li>Symbol 函数前不能使用 new 命令，否则会报错。</li> <li>typeof 的结果为&quot;Symbol&quot;，instanceof 的结果为 false。</li> <li>Symbol 函数可以接受一个字符串作为参数，表示对 Symbol 实例的描述，主要是为了在控制台显示，或者转为字符串时，比较容易区分。</li> <li>如果 Symbol 的参数是一个对象，就会调用该对象的 toString 方法，将其转为字符串，然后才生成一个 Symbol 值。</li> <li>Symbol 函数的参数只是表示对当前 Symbol 值的描述，相同参数的 Symbol 函数的返回值是不相等的。</li> <li>Symbol 值不能与其他类型的值进行运算，会报错。</li> <li>Symbol 值可以显式转为字符串。</li> <li>Symbol 值可以作为标识符，用于对象的属性名，可以保证不会出现同名的属性。</li> <li>Symbol 作为属性名，该属性不会出现在 for...in、for...of 循环中，也不会被 Object.keys()、Object.getOwnPropertyNames()、JSON.stringify() 返回。但是，它也不是私有属性，有一个 Object.getOwnPropertySymbols 方法，可以获取指定对象的所有 Symbol 属性名。</li> <li>如果我们希望使用同一个 Symbol 值，可以使用 Symbol.for。它接受一个字符串作为参数，然后搜索有没有以该参数作为名称的 Symbol 值。如果有，就返回这个 Symbol 值，否则就新建并返回一个以该字符串为名称的 Symbol 值。</li> <li>Symbol.keyFor 方法返回一个已登记的 Symbol 类型值的 key。</li></ol></blockquote> <p>再来看看调用 Symbol 时会发生什么：</p> <blockquote><ol><li>如果使用 new , 就报错</li> <li>如果 description 是 undefined，让 descString 为 undefined</li> <li>否则，让 descString 为 ToString</li> <li>如果报错，就返回</li> <li>返回一个新的唯一的 Symbol 值，它的内部属性 [[Description]] 值为 descString</li></ol></blockquote> <h4 id="demo"><a href="#demo" class="header-anchor">#</a> demo</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> root <span class="token operator">=</span> <span class="token keyword">this</span>

  <span class="token keyword">var</span> generateName <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> postfix <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">descString</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      postfix<span class="token operator">++</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token string">'@@'</span> <span class="token operator">+</span> descString <span class="token operator">+</span> <span class="token string">'_'</span> <span class="token operator">+</span> postfix
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token keyword">var</span> <span class="token function-variable function">SymbolPolyfill</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token parameter">description</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 实现特性第 2 点：Symbol 函数前不能使用 new 命令</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>instanceof <span class="token class-name">SymbolPolyfill</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">'Symbol is not a constructor'</span><span class="token punctuation">)</span>
    <span class="token comment">// 实现特性第 5 点：如果 Symbol 的参数是一个对象，就会调用该对象的 toString 方法，将其转为字符串，然后才生成一个 Symbol 值</span>
    <span class="token keyword">var</span> descString <span class="token operator">=</span> description <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">?</span> <span class="token keyword">undefined</span> <span class="token operator">:</span> <span class="token function">String</span><span class="token punctuation">(</span>description<span class="token punctuation">)</span>

    <span class="token keyword">var</span> symbol <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token function-variable function">toString</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>__Name__
        <span class="token comment">// 实现特性第 8 点：Symbol 值可以显式转为字符串。</span>
        <span class="token comment">// // return 'Symbol(' + this.__Description__ + ')'</span>
      <span class="token punctuation">}</span>，
      <span class="token function-variable function">valueOf</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    Object<span class="token punctuation">.</span><span class="token function">defineProperties</span><span class="token punctuation">(</span>symbol<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token string">'__Description__'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        value<span class="token operator">:</span> descString<span class="token punctuation">,</span>
        writable<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        enumerable<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        configurable<span class="token operator">:</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token string">'__Name__'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        value<span class="token operator">:</span> <span class="token function">generateName</span><span class="token punctuation">(</span>descString<span class="token punctuation">)</span><span class="token punctuation">,</span>
        writable<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        enumerable<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        configurable<span class="token operator">:</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> symbol
  <span class="token punctuation">}</span>

  <span class="token keyword">var</span> forMap <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  Object<span class="token punctuation">.</span><span class="token function">defineProperties</span><span class="token punctuation">(</span>SymbolPolyfill<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token string">'for'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">value</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">description</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">var</span> descString <span class="token operator">=</span> description <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">?</span> <span class="token keyword">undefined</span> <span class="token operator">:</span> <span class="token function">String</span><span class="token punctuation">(</span>description<span class="token punctuation">)</span>
          <span class="token keyword">return</span> forMap<span class="token punctuation">[</span>descString<span class="token punctuation">]</span> <span class="token operator">?</span> forMap<span class="token punctuation">[</span>descString<span class="token punctuation">]</span> <span class="token operator">:</span> forMap<span class="token punctuation">[</span>descString<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">SymbolPolyfill</span><span class="token punctuation">(</span>descString<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      writable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      enumerable<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      configurable<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">'keyFor'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">value</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">symbol</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> forMap<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>forMap<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">===</span> symbol<span class="token punctuation">)</span> <span class="token keyword">return</span> key
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      writable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      enumerable<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      configurable<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  root<span class="token punctuation">.</span>SymbolPolyfill <span class="token operator">=</span> SymbolPolyfill
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="引用数据类型常见问题"><a href="#引用数据类型常见问题" class="header-anchor">#</a> 引用数据类型常见问题</h2> <h3 id="对象的深拷贝和浅拷贝"><a href="#对象的深拷贝和浅拷贝" class="header-anchor">#</a> 对象的深拷贝和浅拷贝</h3> <p>首先要弄明白 JavaScript 是如何复制引用类型的。看如下例子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
<span class="token keyword">let</span> obj2 <span class="token operator">=</span> obj1
<span class="token comment">// eg1</span>
obj2<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">2</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span> <span class="token comment">// { a: 2 }</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj2<span class="token punctuation">)</span> <span class="token comment">// { a: 2 }</span>
<span class="token comment">// eg2</span>
obj1<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">3</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span> <span class="token comment">// { a: 3 }</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj2<span class="token punctuation">)</span> <span class="token comment">// { a: 3 }</span>
<span class="token comment">// eg3</span>
obj2<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token string">'b'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span> <span class="token comment">// {a: 3, b: &quot;b&quot;}</span>
</code></pre></div><p>eg1 中只修改了 obj2 中的 a 属性，obj1 中的 a 属性却同时改变了。eg2 中修改了 obj1 中的 a 属性，obj2 中的 a 属性也同时改变了。eg3 中给 obj2 新增了一个 b 属性，obj1 中也增加了 b 属性。看起来，obj1 和 obj2 所指向的是同一个对象。</p> <p>这就要从对象的底层存储来分析了。</p> <p><img src="/images/base-1-1-1.png" alt="保存在栈中的变量和堆内存中对象的关系"></p> <h4 id="浅拷贝"><a href="#浅拷贝" class="header-anchor">#</a> 浅拷贝</h4> <p>对浅拷贝的定义可以理解为：</p> <blockquote><p>当创建一个对象的时候，该对象有着对原始对象属性值的一份精确拷贝，拷贝的值始终是栈内存中的值。由于基本类型在栈内存中存放的就是属性值，则拷贝时拷贝的就是基本数据类型的值。由于引用类型栈内存中存放的是指向堆内存中的对象的值的指针，所以拷贝的就是其内存地址，因此其中一个对象的值修改的时候，就会影响到另一个对象。</p></blockquote> <h4 id="深拷贝"><a href="#深拷贝" class="header-anchor">#</a> 深拷贝</h4> <p>由于在实际应用中，我们在操作对象时，往往不希望拷贝出来的对象对原始对象造成污染。因此对于引用类型，我们希望在对内存中开辟一块新的内存地址用于存放复制的对象，并将原始对象的值复制过来。所以对于<strong>对象</strong>，我们需要深拷贝，即：</p> <blockquote><p>将一个对象从内存中完整的拷贝一份出来，从堆内存中开辟一个新的区域存放新对象，且修改新对象不会影响原对象。</p></blockquote></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/Yaaawn/blog/edit/master/docs/papers/base/1.1.md" target="_blank" rel="noopener noreferrer">帮助我们改善此页面！</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/blog/papers/base/1.2.html">如何判断数据类型？</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.15abdfdd.js" defer></script><script src="/blog/assets/js/2.d82f687a.js" defer></script><script src="/blog/assets/js/9.e3aba813.js" defer></script>
  </body>
</html>
